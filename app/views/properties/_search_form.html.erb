<%= form_with url: properties_path, method: :get, local: true,
             data: { controller: "search", turbo_frame: "properties" },
             class: "space-y-6" do |form| %>

  <!-- Main Search Row -->
  <div class="grid grid-cols-1 lg:grid-cols-5 gap-4">
    <!-- Keyword Search -->
    <div class="lg:col-span-2">
      <%= form.label :search, class: "block text-sm font-medium text-gray-700 mb-2" do %>
        <div class="flex items-center">
          <svg class="w-5 h-5 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          What are you looking for?
        </div>
      <% end %>
      <div class="relative">
        <%= form.text_field :search, value: params[:search],
                           placeholder: "Enter location, amenities, or keywords...",
                           class: "w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                           data: { action: "input->search#search" } %>
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
      </div>
    </div>

    <!-- Property Type -->
    <div>
      <%= form.label :property_type, class: "block text-sm font-medium text-gray-700 mb-2" do %>
        <svg class="w-5 h-5 text-indigo-600 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
        Property Type
      <% end %>
      <%= form.select :property_type,
                     options_for_select([["Any Type", ""]] + Property.property_types.keys.map { |k| [k.humanize, k] }, params[:property_type]),
                     {},
                     class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                     data: { action: "change->search#submit" } %>
    </div>

    <!-- Price Range -->
    <div class="lg:col-span-2">
      <%= form.label :price_range, class: "block text-sm font-medium text-gray-700 mb-2" do %>
        <svg class="w-5 h-5 text-indigo-600 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        Price Range
      <% end %>
      <div class="grid grid-cols-2 gap-3">
        <%= form.number_field :min_price, value: params[:min_price],
                             placeholder: "Min price",
                             class: "px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                             data: { action: "input->search#search" } %>
        <%= form.number_field :max_price, value: params[:max_price],
                             placeholder: "Max price",
                             class: "px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                             data: { action: "input->search#search" } %>
      </div>
    </div>
  </div>

  <!-- Advanced Filters Toggle -->
  <div class="flex justify-center">
    <button type="button"
            data-action="click->search#toggleAdvanced"
            class="flex items-center text-indigo-600 hover:text-indigo-800 font-medium transition-colors duration-200">
      <span>Advanced Filters</span>
      <svg data-search-target="advancedIcon" class="w-4 h-4 ml-2 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </button>
  </div>

  <!-- Advanced Filters -->
  <div data-search-target="advanced" class="hidden bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-2xl border border-indigo-100">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
      <svg class="w-5 h-5 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
      </svg>
      Advanced Search Options
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Bedrooms -->
      <div>
        <%= form.label :min_bedrooms, "Bedrooms", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :min_bedrooms,
                       options_for_select([["Any", ""], ["1+", 1], ["2+", 2], ["3+", 3], ["4+", 4], ["5+", 5]], params[:min_bedrooms]),
                       {},
                       class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                       data: { action: "change->search#submit" } %>
      </div>

      <!-- Bathrooms -->
      <div>
        <%= form.label :min_bathrooms, "Bathrooms", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :min_bathrooms,
                       options_for_select([["Any", ""], ["1+", 1], ["2+", 2], ["3+", 3]], params[:min_bathrooms]),
                       {},
                       class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                       data: { action: "change->search#submit" } %>
      </div>

      <!-- Square Feet -->
      <div>
        <%= form.label :min_sqft, "Min Size (sqft)", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.number_field :min_sqft, value: params[:min_sqft],
                             placeholder: "e.g., 1000",
                             class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                             data: { action: "input->search#search" } %>
      </div>

      <!-- Availability -->
      <div>
        <%= form.label :available_by, "Available By", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.date_field :available_by, value: params[:available_by],
                           class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                           data: { action: "change->search#submit" } %>
      </div>

      <!-- Furnished -->
      <div>
        <%= form.label :furnished, "Furnished", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :furnished,
                       options_for_select([["Any", ""], ["Furnished", "true"], ["Unfurnished", "false"]], params[:furnished]),
                       {},
                       class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                       data: { action: "change->search#submit" } %>
      </div>

      <!-- Pets Allowed -->
      <div>
        <%= form.label :pets_allowed, "Pets Allowed", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :pets_allowed,
                       options_for_select([["Any", ""], ["Yes", "true"], ["No", "false"]], params[:pets_allowed]),
                       {},
                       class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                       data: { action: "change->search#submit" } %>
      </div>

      <!-- Sort By -->
      <div>
        <%= form.label :sort, "Sort By", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :sort,
                       options_for_select([
                         ["Newest", "newest"],
                         ["Price: Low to High", "price_low_high"],
                         ["Price: High to Low", "price_high_low"],
                         ["Most Bedrooms", "bedrooms"],
                         ["Largest", "size"]
                       ], params[:sort]),
                       {},
                       class: "w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200",
                       data: { action: "change->search#submit" } %>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="flex flex-wrap gap-4 justify-center pt-6 border-t border-gray-200">
    <%= form.submit "Search Properties",
                   class: "btn-primary-lg px-8 py-4 text-lg font-semibold hover:shadow-lg transform hover:scale-105 transition-all duration-200" %>

    <%= link_to "Reset Filters", properties_path,
               class: "btn-secondary-lg px-6 py-3 hover:bg-gray-50 transition-all duration-200" %>

    <%= link_to properties_path(view: 'map', **request.query_parameters),
               class: "btn-outline-lg px-6 py-3 hover:bg-indigo-50 transition-all duration-200 group" do %>
      <svg class="w-5 h-5 mr-2 text-indigo-600 group-hover:text-indigo-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
      </svg>
      Map View
    <% end %>
  </div>
<% end %>
